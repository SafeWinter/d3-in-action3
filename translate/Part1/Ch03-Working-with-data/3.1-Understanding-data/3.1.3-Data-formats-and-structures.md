### 3.1.3 数据的格式与结构

Data can be formatted in a variety of manners for various purposes. Still, it tends to fall into a few recognizable structures: tabular data, JavaScript objects (JSON), nested data, networks, geographic data, or raw data. Those structures aren’t mutually exclusive.
可以出于各种目的以多种方式格式化数据。尽管如此，它往往属于一些可识别的结构：表格数据、JavaScript 对象 (JSON)、嵌套数据、网络、地理数据或原始数据。这些结构并不相互排斥。

#### 1 Tabular 表格

Tabular data appears in columns and rows and is typically found in a spreadsheet or a table in a database. Tabular data is separated with a particular character, called a delimiter, which defines its format. The most common tabular data format is Comma-Separated Values (CSV) files, where the delimiter is a comma. We can also meet Tab-Delimited Values (TSV) files or any other Delimiter-Separated Values (DSV) files that use specific delimiters such as pipes or semicolons.
表格数据出现在列和行中，通常可以在电子表格或数据库中的表格中找到。表格数据用称为分隔符的特定字符分隔，它定义了其格式。最常见的表格数据格式是逗号分隔值 (CSV) 文件，其中分隔符是逗号。我们还可以遇到制表符分隔值 (TSV) 文件或使用特定分隔符（例如管道或分号）的任何其他分隔符分隔值 (DSV) 文件。

As an example, let’s take a sample from our fictional employees’ dataset, discussed in chapter 1. If we saved this data as a CSV, TSV, or DSV file, values would be respectively separated by a comma, a tab, or another delimiter, as listed in table 3.1. In tabular datasets, the first line usually lists the column headers, and each row of data is listed on a new line.
作为示例，让我们从第 1 章中讨论的虚构员工数据集中获取一个样本。如果我们将此数据保存为 CSV、TSV 或 DSV 文件，则值将分别用逗号、制表符或其他分隔符分隔，如表3.1所示。在表格数据集中，第一行通常列出列标题，每行数据都在新行中列出。

**表 3.1 以 CSV、TSV 和 DSV 格式表示的分隔数据**

![](../../../assets/3.1.2.png)

D3 provides three different functions to load tabular data: `d3.csv()`, `d3.tsv()`, and `d3.dsv()`. The only difference between them is that `d3.csv()` is built for comma-delimited files, `d3.tsv()` is for tab-delimited files, and `d3.dsv()` allows you to declare a delimiter. You’ll see `d3.csv()` in action in this chapter and throughout the book.
D3 提供了三种不同的函数来加载表格数据： `d3.csv()` 、 `d3.tsv()`和`d3.dsv()` 。它们之间的唯一区别是`d3.csv()`是为逗号分隔文件构建的， `d3.tsv()`是为制表符分隔文件构建的，而`d3.dsv()`允许您声明分隔符。您将在本章和整本书中看到`d3.csv()`实际应用。

#### 2 JSON

JavaScript Object Notation (JSON) files are a common way to store simple data structures. Developers regularly use them, especially when fetching information from API endpoints, which often provide data in JSON format only.
JavaScript 对象表示法 (JSON) 文件是存储简单数据结构的常用方法。开发人员经常使用它们，尤其是从 API 端点获取信息时，这些端点通常仅提供 JSON 格式的数据。

If we stored the data from table 3.1 in a JSON format rather than tabular, it would look like the following array of objects. Although it’s not the most compact, the object notation has the significant advantage of making the data key-value pairs easy to access with the JavaScript dot notation discussed in chapter 1:
如果我们以 JSON 格式而不是表格形式存储表 3.1 中的数据，则它将类似于以下对象数组。尽管它不是最紧凑的，但对象表示法具有显着的优点，可以使用第 1 章中讨论的 JavaScript 点表示法轻松访问数据键值对：

```json
[
  {
    id": 1,
    "name": "Zoe",
    "position": "Data analyst",
    "works_with_d3": false
  },
  {
    "id": 2,
    "name": "James",
    "position": "Frontend developer",
    "works_with_d3": true
  },
  {
    "id": 3,
    "name": "Alice",
    "position": "Fullstack developer",
    "works_with_d3": true
  },
  {
    "id": 4,
    "name": "Hubert",
    "position": "Designer",
    "works_with_d3": false
  }
]
```

In D3, we use the function `d3.json()` to load JSON files. But even when you load another type of tabular data, such as a CSV file, D3 will transform the data into an array of objects, hence ending up with a JSON-like structure.
在D3中，我们使用函数`d3.json()`来加载JSON文件。但即使当您加载另一种类型的表格数据（例如 CSV 文件）时，D3 也会将数据转换为对象数组，从而最终得到类似 JSON 的结构。

#### 3 Nested 嵌套

<img src="../../../assets/3.5.png" style="zoom:50%;" />

**图 3.5嵌套数据表示对象的父/子关系，通常每个对象都有一个子对象数组，并以多种形式表示，例如此树状图。请注意，每个对象只能有一个父对象**

Nested data, with objects existing as children of objects recursively, is common. Many of the most intuitive layouts in D3 are based on nested data, which can be represented as trees, such as the one in figure 3.5, or packed in circles or boxes. Pulling out nested datasets requires a bit of additional scripting, but the flexibility of this representation is worth the effort. You’ll see hierarchical data in detail in chapter 11.
嵌套数据（对象以递归方式作为对象的子对象存在）很常见。 D3 中许多最直观的布局都基于嵌套数据，这些数据可以表示为树，如图 3.5 中的树，也可以封装在圆圈或方框中。提取嵌套数据集需要一些额外的脚本，但这种表示的灵活性值得付出努力。您将在第 11 章中详细了解分层数据。



#### 4 network 网络

Networks are everywhere. Whether they’re the raw output of social networking streams, transportation networks, or a flowchart, networks are a powerful method of delivering an understanding of complex systems. Networks are often represented as node-link diagrams, as shown in figure 3.6. Like geographic data, network data has many standards, but this text focuses on node/edge lists. Network data can also be easily explored by using a freely available network analysis tool such as Gephi (available at [https://gephi.org](https://gephi.org/)). We’ll examine network data and network data standards when we deal with network visualizations in chapter 12.
网络无处不在。无论是社交网络流、交通网络还是流程图的原始输出，网络都是理解复杂系统的强大方法。网络通常表示为节点链路图，如图 3.6 所示。与地理数据一样，网络数据也有许多标准，但本文重点关注节点/边列表。还可以使用免费的网络分析工具（例如 Gephi（可从[https://gephi.org](https://gephi.org/)获取））轻松探索网络数据。当我们在第 12 章处理网络可视化时，我们将研究网络数据和网络数据标准。

<img src="../../../assets/3.6.png" style="zoom:50%;" />

**图 3.6网络数据由对象及其之间的连接组成。对象通常称为节点或顶点，连接称为边或链接。网络通常使用力导向算法来表示，例如此处的示例，该算法以将连接的节点拉向彼此的方式排列网络**



#### 5 Geographic 地理

Geographic data refers to locations either as points or shapes, and it’s used to create the variety of online maps seen on the web today, such as the world map in figure 3.7 or the ones in Observable’s gallery (https://observablehq.com/@d3/gallery#maps). The incredible popularity of web mapping means that you can get access to a massive amount of publicly accessible geodata for any project. Geographic data has a few standards, but the focus in this book is on two: the GeoJSON and TopoJSON standards. Although geodata may come in many forms, readily available geographic information systems (GIS) tools such as PostGIS ([https://postgis.net](https://postgis.net/)) allow developers to transform the data into GIS format for ready delivery to the web. We’ll look at geographic data closely in chapter 13.
地理数据以点或形状的形式指代位置，它用于创建当今网络上看到的各种在线地图，例如图 3.7 中的世界地图或 Observable 画廊中的地图 ( [https://observablehq.com/ @d3/gallery#maps](https://observablehq.com/@d3/gallery#maps) ）。网络地图的惊人普及意味着您可以访问任何项目的大量可公开访问的地理数据。地理数据有一些标准，但本书的重点是两个：GeoJSON 和 TopoJSON 标准。尽管地理数据可能有多种形式，但 PostGIS ( [https://postgis.net](https://postgis.net/) ) 等现成的地理信息系统 (GIS) 工具允许开发人员将数据转换为 GIS 格式，以便随时交付到网络。我们将在第 13 章仔细研究地理数据。

![](../../../assets/3.7.png)

**图3.7 地理数据存储物体的空间几何形状。该图像中的每个国家/地区都表示为一个单独的特征，并带有指示其形状的值数组。地理数据还可以由点（例如，城市）或线（例如，道路）组成**



#### 6 Raw 原始数据

As you explore the field of data visualization, you’ll discover that everything is data, including images, blocks of text, and a website’s markup. Although information visualization typically uses shapes encoded by color and size to represent data, sometimes the best way to visualize it in D3 is with linear narrative text, an image, or a video. If you develop applications for an audience that needs to understand complex systems, but you consider the manipulation of text or images to be somehow separate from the representation of numerical or categorical data as shapes, then you arbitrarily reduce your capability to communicate. The layouts and formatting used when dealing with text and images, typically tied to older modes of web publication, are possible in D3.
当您探索数据可视化领域时，您会发现一切都是数据，包括图像、文本块和网站的标记。尽管信息可视化通常使用由颜色和大小编码的形状来表示数据，但有时在 D3 中可视化数据的最佳方式是使用线性叙述文本、图像或视频。如果您为需要理解复杂系统的受众开发应用程序，但您认为文本或图像的操作在某种程度上与数字或分类数据作为形状的表示是分开的，那么您就任意降低了沟通能力。处理文本和图像时使用的布局和格式（通常与旧的 Web 发布模式相关）在 D3 中是可能的。